---
title:  "[Pytorch] íŒŒì´í† ì¹˜ ì„¤ì¹˜ì™€ í…ì„œ ë‹¤ë£¨ê¸°"
toc: true
toc_sticky: true
header:
  teaser: /assets/images/deep_learning.jpg

categories:
  - Pytorch
tags:
  - AI
last_modified_at: 2021-07-10
---  

## 1. íŒŒì´í† ì¹˜ 
íŒŒì´í† ì¹˜PyTorchëŠ” 2017ë…„ ì´ˆì— ê³µê°œëœ `ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬`ë¡œ ê°œë°œìë“¤ê³¼ ì—°êµ¬ìë“¤ì´ ì‰½ê²Œ `GPUë¥¼ í™œìš©í•˜ì—¬ ì¸ê³µ ì‹ ê²½ë§ ëª¨ë¸ì„ ë§Œë“¤ê³  í•™ìŠµ`ì‹œí‚¬ ìˆ˜ ìˆê²Œ ë„ì™€ ì¤ë‹ˆë‹¤. íŒŒì´í† ì¹˜ì˜ ì „ì‹ ì´ë¼ê³  í•  ìˆ˜ ìˆëŠ” í† ì¹˜TorchëŠ” ë£¨ì•„ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¡œ ë˜ì–´ ìˆì—ˆì§€ë§Œ, íŒŒì´í† ì¹˜ëŠ” íŒŒì´ì¬ìœ¼ë¡œ ì‘ì„±ë˜ì–´ íŒŒì´ì¬ì˜ ì–¸ì–´ íŠ¹ì§•ì„ ë§ì´ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. íŒŒì´í† ì¹˜ëŠ” `í˜ì´ìŠ¤ë¶ì˜ ì¸ê³µì§€ëŠ¥ ì—°êµ¬íŒ€AI` Research ë©¤ë²„ë“¤ì´ ì£¼ë¡œ ê´€ë¦¬í•˜ë©°, ë…ìì ìœ¼ë¡œ ìš´ì˜ë˜ëŠ” íŒŒì´í† ì¹˜ í¬ëŸ¼ì€ ì‚¬ëŒë“¤ì´ ì§ˆë¬¸ì„ ì˜¬ë¦¬ë©´ í”„ë ˆì„ì›Œí¬ ê°œë°œìë¥¼ ë¹„ë¡¯í•œ ë§ì€ ì‚¬ëŒì´ ë‹µì„ í•´ì£¼ëŠ” ë“± í™œë°œíˆ êµë¥˜ê°€ ì¼ì–´ë‚˜ê³  ìˆìŠµë‹ˆë‹¤.  

## 2. ë‹¤ë¥¸ í”„ë ˆì„ì›Œí¬ì™€ì˜ ë¹„êµ  

### ë„˜íŒŒì´ vs íŒŒì´í† ì¹˜ 

ë„˜íŒŒì´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ íŒŒì´í† ì¹˜ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì˜  í° ì°¨ì´ì  ì¤‘ í•˜ë‚˜ëŠ” `GPUë¥¼ í†µí•œ ì—°ì‚° ê°€ëŠ¥ ì—¬ë¶€`ì…ë‹ˆë‹¤. ë„˜íŒŒì´ë§Œìœ¼ë¡œëŠ” GPUë¡œ ê°’ë“¤ì„ ë³´ë‚´ ì—°ì‚°ì„ ëŒë¦¬ê³  ë‹¤ì‹œ ë°›ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ì— ë¹„í•´ íŒŒì´í† ì¹˜ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ CUDA, cuDNNì´ë¼ëŠ” APIë¥¼ í†µí•´ GPUë¥¼ ì—°ì‚°ì— ì‚¬ìš©í•  ìˆ˜ ìˆê³ , ì´ë¡œ ì¸í•´ ìƒê¸°ëŠ” ì—°ì‚° ì†ë„ì˜ ì°¨ì´ëŠ” ì—„ì²­ë‚©ë‹ˆë‹¤. CUDAëŠ” ì—”ë¹„ë””ì•„ê°€ GPUë¥¼ í†µí•œ ì—°ì‚°ì„ ê°€ëŠ¥í•˜ê²Œ ë§Œë“  API ëª¨ë¸ì´ë©°, cuDNNì€ CUDAë¥¼ ì´ìš©í•´ ë”¥ëŸ¬ë‹ ì—°ì‚°ì„ ê°€ì†í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.   

 
ë³‘ë ¬ ì—°ì‚°ì—ì„œ GPUì˜ ì†ë„ëŠ” CPUì˜ ì†ë„ë³´ë‹¤ ì›”ë“±íˆ ë¹ ë¥´ë©° ì´ ì°¨ì´ëŠ” ì§€ì†ì ìœ¼ë¡œ ë²Œì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤. CUDAì™€ cuDNNì„ ë‘˜ ë‹¤ ì‚¬ìš©í•˜ë©´ ì—°ì‚° ì†ë„ê°€ CPUì˜ 15ë°° ì´ìƒì´ ëœë‹¤ê³  ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤. CPUë¡œ í•œ ë‹¬ ê±¸ë¦´ ì—°ì‚°ì„ ì´í‹€ì´ë©´ í•  ìˆ˜ ìˆëŠ” ì…ˆì…ë‹ˆë‹¤. ì‹¬ì¸µ ì‹ ê²½ë§ì„ ë§Œë“¤ ë•Œ í•¨ìˆ˜ ë° ê¸°ìš¸ê¸° ê³„ì‚°, ê·¸ë¦¬ê³  GPUë¥¼ ì´ìš©í•œ ì—°ì‚° ê°€ì† ë“±ì˜ ì¥ì ì´ ìˆê¸° ë•Œë¬¸ì— ë”¥ëŸ¬ë‹ ê°œë°œ ì‹œ í”„ë ˆì„ì›Œí¬ì˜ ì‚¬ìš©ì€ í•„ìˆ˜ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.   

### í…ì„œí”Œë¡œ vs íŒŒì´í† ì¹˜

í…ì„œí”Œë¡œì™€ íŒŒì´í† ì¹˜ëŠ” ë‘˜ ë‹¤ ì—°ì‚°ì— GPUë¥¼ ì´ìš©í•˜ëŠ” í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ í…ì„œí”Œë¡œëŠ” ì—°ì‚° ê·¸ë˜í”„ë¥¼ ë¨¼ì € ë§Œë“¤ê³  ì‹¤ì œ ì—°ì‚°í•  ë•Œ ê°’ì„ ì „ë‹¬í•˜ì—¬ ê²°ê³¼ë¥¼ ì–»ëŠ” `â€˜Define and Runâ€™` ë°©ì‹ì´ê³ , íŒŒì´í† ì¹˜ëŠ” ê·¸ë˜í”„ë¥¼ ë§Œë“¦ê³¼ ë™ì‹œì— ê°’ì´ í• ë‹¹ë˜ëŠ” â€˜Define by Runâ€™ ë°©ì‹ì…ë‹ˆë‹¤. í…ì„œí”Œë¡œì˜ â€˜ê·¸ë˜í”„ë¥¼ ë¨¼ì € ì •ì˜í•˜ê³  ì„¸ì…˜ì—ì„œ ì‹¤ì œë¡œ ê°’ì„ ì§‘ì–´ë„£ì–´ ê²°ê³¼ë¥¼ ë„ì¶œâ€™í•˜ëŠ” íŒ¨ëŸ¬ë‹¤ì„ì€ ì‚¬ëŒì— ë”°ë¼ ì§ê´€ì ìœ¼ë¡œ ë°›ì•„ë“¤ì´ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆê³ , ê·¸ë˜í”„ë¥¼ ì •ì˜í•˜ëŠ” ë¶€ë¶„ê³¼ ì´ë¥¼ ëŒë¦¬ëŠ” ë¶€ë¶„ì´ ë¶„ë¦¬ë˜ê¸° ë•Œë¬¸ì— ì „ì²´ì ìœ¼ë¡œë„ ì½”ë“œ ê¸¸ì´ê°€ ê¸¸ì–´ì§€ê²Œ ë©ë‹ˆë‹¤. ë°˜ë©´ íŒŒì´í† ì¹˜ëŠ” ì—°ì‚° ê·¸ë˜í”„ë¥¼ ì •ì˜í•˜ëŠ” ê²ƒê³¼ ë™ì‹œì— ê°’ë„ ì´ˆê¸°í™”ë˜ì–´ ì—°ì‚°ì´ ì´ë£¨ì–´ì§€ëŠ” â€˜Define by Runâ€™ì´ë¯€ë¡œ ì—°ì‚° ê·¸ë˜í”„ì™€ ì—°ì‚°ì„ ë¶„ë¦¬í•´ì„œ ìƒê°í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.  


ë˜í•œ `ì—°ì‚° ì†ë„`ì—ì„œë„ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤. ì—°ì‚° ê·¸ë˜í”„ë¥¼ ê³ ì •í•´ë†“ê³  ê°’ë§Œ ì „ë‹¬í•˜ëŠ” í…ì„œí”Œë¡œê°€ ë” ë¹ ë¥¸ í™˜ê²½ë„ ìˆì„ ìˆ˜ ìˆê² ì§€ë§Œ, í…ì„œí”Œë¡œ ê¹ƒí—ˆë¸Œì— ì˜¬ë¼ì˜¨ ì´ìŠˆì— ë”°ë¥´ë©´ ì‹¤í—˜ì— ë§ì´ ì‚¬ìš©ë˜ëŠ” ëª¨ë¸ë¡œ ë²¤ì¹˜ë§ˆí‚¹í•œ ê²°ê³¼ íŒŒì´í† ì¹˜ê°€ í…ì„œí”Œë¡œë³´ë‹¤ 2.5ë°° ë¹ ë¥¸ ê²°ê³¼ê°€ ë‚˜ì™”ë‹¤ê³  í•©ë‹ˆë‹¤. ì´ìŠˆë¥¼ ì˜¬ë¦° ì‚¬ëŒì´ ì‹¤í—˜ í™˜ê²½ì„ ê³µê°œí•˜ì—¬ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ê°™ì€ ì½”ë“œë¡œ ì‹¤í—˜í•œ ê²°ê³¼ ì—­ì‹œ íŒŒì´í† ì¹˜ê°€ ë¹ ë¥´ê²Œ ë‚˜ì™”ìŠµë‹ˆë‹¤. ëª¨ë¸ë§ˆë‹¤, ì‚¬ìš©í•œ í•¨ìˆ˜ë§ˆë‹¤ ì°¨ì´ëŠ” ìˆê² ì§€ë§Œ íŒŒì´í† ì¹˜ëŠ” ì „ë°˜ì ìœ¼ë¡œ ì†ë„ ë©´ì—ì„œ í…ì„œí”Œë¡œë³´ë‹¤ ë¹ ë¥´ê±°ë‚˜, ì ì–´ë„ ë°€ë¦¬ì§€ëŠ” ì•ŠëŠ”ë‹¤ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
 

í…ì„œí”Œë¡œê°€ 1ë…„ ì •ë„ ë¨¼ì € ë”¥ëŸ¬ë‹ì´ ëœ¨ê¸° ì‹œì‘í•  ë•Œ ë°œí‘œë˜ì–´ ì‚¬ìš©ìê°€ ë§ì€ ê²ƒì€ ì‚¬ì‹¤ì…ë‹ˆë‹¤. ì´ì— ë¹„í•´ íŒŒì´í† ì¹˜ëŠ” ë’¤ëŠ¦ê²Œ ì‚¬ëŒë“¤ì—ê²Œ ì•Œë ¤ì§€ê³  ìˆëŠ” ìƒíƒœì…ë‹ˆë‹¤. í…ì„œí”Œë¡œëŠ” ìì²´ì ìœ¼ë¡œ ìš´ì˜í•˜ëŠ” í¬ëŸ¼ì´ ì—†ê³  êµ¬ê¸€ ê·¸ë£¹ë„ í¸ë¦¬í•˜ê²Œ ì •ë¦¬ë˜ì–´ ìˆì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. ë°˜ë©´ íŒŒì´í† ì¹˜ëŠ” ìì²´ ìš´ì˜ í¬ëŸ¼ì´ ìˆì–´ì„œ ì§ˆë¬¸ì„ ì˜¬ë¦¬ë©´ íŒŒì´í† ì¹˜ ê°œë°œìë“¤ì´ ì§ì ‘ ë‹µë³€ì„ ë‹¬ì•„ì£¼ê¸°ë„ í•©ë‹ˆë‹¤. í•œêµ­ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ë³´ë©´ í…ì„œí”Œë¡œëŠ” Tensorflow-KR, íŒŒì´í† ì¹˜ëŠ” PyTorch-KR í˜ì´ìŠ¤ë¶ ê·¸ë£¹ì´ ìˆìœ¼ë©°, ë§ì€ ì‚¬ëŒì´ ì§ˆë¬¸ì„ ì˜¬ë¦¬ê±°ë‚˜ ìœ ìš©í•œ íŒì„ ê³µìœ í•˜ê³  ìˆìŠµë‹ˆë‹¤.  

## 3. íŒŒì´í† ì¹˜ ì„¤ì¹˜  
[íŒŒì´í† ì¹˜ í™ˆí˜ì´ì§€](https://pytorch.org/get-started/locally/)ì— ì ‘ì† í›„ ì›í•˜ëŠ” ê°’ì„ ì„¤ì •í•˜ê³  ë°‘ì— ë‚˜íƒ€ë‚˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì•„ë‚˜ì½˜ë‹¤ í”„ë¡¬í”„íŠ¸ ì°½ì— ì…ë ¥   
![](/assets/images/pytorch_2.png){: width="100%"}  

ì €ê°™ì€ ê²½ìš°ì—ëŠ” CUDA 11.0 ë²„ì „ì„ í•„ìš”ë¡œ í–ˆê¸°ì— íŒŒì´í† ì¹˜ 1.7 ë²„ì „ëŒ€ë¥¼ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ Previous Pytorch Versionsì—ì„œ ì œê°€ ì›í•˜ëŠ” ì„¸íŒ…ê°’ì„ ê³¨ëìŠµë‹ˆë‹¤.  

![](/assets/images/pytorch_6.png){: width="100%"}  

![](/assets/images/pytorch_4.png){: width="100%"}  

![](/assets/images/pytorch_3.png){: width="100%"}  

íŒŒì´í† ì¹˜ê°€ ì˜ ì„¤ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.  

![](/assets/images/pytorch_5.png){: width="100%"}  



## 4. í…ì„œ ì—°ì‚°  

### íŒŒì´í† ì¹˜ì˜ í…ì„œ  

![](/assets/images/pytorch_7.png){: width="80%"}  


- íŒŒì´í† ì¹˜ì˜ ê¸°ë³¸ ë‹¨ìœ„
- ë‹¤ì°¨ì› ë°°ì—´ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë°ì´í„° êµ¬ì¡°
- Numpyì˜ ndarrayì™€ ê±°ì˜ ê°™ì€ APIë¥¼ ì§€ë‹ˆê³  ìˆë‹¤.
- GPUë¥¼ ì‚¬ìš©í•œ ê³„ì‚°ë„ ì§€ì›í•œë‹¤.
- ì–´ë–¤ ë°ì´í„° í˜•ì˜ í…ì„œì´ê±´ torch.tensorë¼ëŠ” í•¨ìˆ˜ë¡œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.  

```python
import torch

torch.__version__
--------------------
'1.7.1'
```  

```python
a = torch.FloatTensor([[1, 2], [3, 4]])
b = torch.LongTensor([[1, 2], [3, 4]])
c = torch.ByteTensor([[1, 2], [3, 4]])
```  

```python
a.shape
a.size()
a.size(-1)
a.dim()
-----------
torch.Size([2, 2])
torch.Size([2, 2])
2
2
```  

```python
# í…ì„œë¥¼ ë„˜íŒŒì´ ë°°ì—´ë¡œ
a = a.numpy()

# ë„˜íŒŒì´ ë°°ì—´ì„ í…ì„œë¡œ
a = torch.from_numpy(a)
```  

```python
a = torch.FloatTensor([[1, 2],
                       [3, 4]])
b = torch.FloatTensor([[2, 2],
                       [3, 3]])

a+b
-------------------------
tensor([[3., 4.],
        [6., 7.]])

a-b
-------------------------
tensor([[-1.,  0.],
        [ 0.,  1.]])

a*b
-------------------------
tensor([[ 2.,  4.],
        [ 9., 12.]])

a/b
-------------------------
tensor([[0.5000, 1.0000],
        [1.0000, 1.3333]])

a==b
-------------------------
tensor([[False,  True],
        [ True, False]])

a**b
-------------------------
tensor([[ 1.,  4.],
        [27., 64.]])
```  

```python
a = torch.FloatTensor([[1, 2],
                       [3, 4]])
b = torch.FloatTensor([[2, 2],
                       [3, 3]])

# a*bì˜ ê²°ê³¼ë¥¼ ë¦¬í„´
a.mul(b)

# a*bì˜ ê²°ê³¼ë¥¼ aì— ë¦¬í„´
a.mul_(b)

# a+bì˜ ê²°ê³¼ë¥¼ aì— ë¦¬í„´
a.add_(b)
```  

```python
a = torch.FloatTensor([[1, 2],
                       [3, 4]])

a.sum()
a.mean()
----------
10
2.5

a.sum(dim=0)
a.sum(dim=-1)
--------------
tensor([4., 6.])
tensor([3., 7.])
```

```python
x = torch.FloatTensor([[[1, 2],
                        [3, 4]],
                       [[5, 6],
                        [7, 8]],
                       [[9, 10],
                        [11, 12]]])

x.reshape(12)
x.reshape(-1)
------------------------------------
tensor([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.])
tensor([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.])


x.reshape(3, 1, 4)
x.reshape(-1, 1, 4)
------------------------------------
tensor([[[ 1.,  2.,  3.,  4.]],

        [[ 5.,  6.,  7.,  8.]],

        [[ 9., 10., 11., 12.]]])
tensor([[[ 1.,  2.,  3.,  4.]],

        [[ 5.,  6.,  7.,  8.]],

        [[ 9., 10., 11., 12.]]])
```

```python
# size: (1, 2, 2)
x = torch.FloatTensor([[[1, 2],
                        [3, 4]]])

# size: (2, 2)
x = x.squeeze()

# size: (1, 2, 2)
x = x.unsqueeze(0)

# size: (2, 1, 2)
x = x.unsqueeze(1)

# size: (2, 2, 1)
x = x.unsqueeze(-1)
```  
![](/assets/images/pytorch_8.png){: width="100%"}  

```python
x = torch.FloatTensor([[[1, 2],
                        [3, 4]],
                       [[5, 6],
                        [7, 8]],
                       [[9, 10],
                        [11, 12]]])

x[0]
x[0, :]
x[0, :, :]
-------------------------------------
tensor([[1., 2.],
        [3., 4.]])
tensor([[1., 2.],
        [3., 4.]])
tensor([[1., 2.],
        [3., 4.]])

x[1:3, :, :]
----------------------------------------
tensor([[[ 5.,  6.],
         [ 7.,  8.]],

        [[ 9., 10.],
         [11., 12.]]])
```

```python
x = torch.FloatTensor(10, 4)

# 4ê°œì”© ìë¥¸ë‹¤
splits = x.split(4, dim=0)

splits
----------------------------------------------------------
(tensor([[0.0000e+00, 1.0102e-38, 1.8788e+31, 1.7220e+22],
         [1.8704e+20, 6.5986e-10, 1.3029e-11, 1.0524e+21],
         [2.0314e+20, 6.6766e-07, 1.7000e+22, 1.7567e-04],
         [4.1765e-08, 2.4693e-18, 1.8788e+31, 7.9303e+34]]),
 tensor([[6.1949e-04, 2.8183e+20, 3.2995e-18, 1.9421e+31],
         [2.7491e+20, 6.1949e-04, 7.1856e+22, 4.3605e+27],
         [2.3329e-18, 1.9284e+31, 3.2314e-18, 6.6448e+22],
         [1.6805e-04, 1.6149e-07, 5.2711e-08, 2.6586e+23]]),
 tensor([[2.0891e+20, 2.6965e+23, 4.3125e-08, 2.4286e-18],
         [2.6302e+20, 6.1949e-04, 1.0256e-08, 6.5631e-07]]))

# 3ê°œì˜ ë©ì–´ë¦¬ë¡œ ë‚˜ëˆˆë‹¤
chunks = x.chunk(3, dim=0)

chunks
---------------------------------------------------------
(tensor([[0.0000e+00, 1.0102e-38, 1.8788e+31, 1.7220e+22],
         [1.8704e+20, 6.5986e-10, 1.3029e-11, 1.0524e+21],
         [2.0314e+20, 6.6766e-07, 1.7000e+22, 1.7567e-04],
         [4.1765e-08, 2.4693e-18, 1.8788e+31, 7.9303e+34]]),
 tensor([[6.1949e-04, 2.8183e+20, 3.2995e-18, 1.9421e+31],
         [2.7491e+20, 6.1949e-04, 7.1856e+22, 4.3605e+27],
         [2.3329e-18, 1.9284e+31, 3.2314e-18, 6.6448e+22],
         [1.6805e-04, 1.6149e-07, 5.2711e-08, 2.6586e+23]]),
 tensor([[2.0891e+20, 2.6965e+23, 4.3125e-08, 2.4286e-18],
         [2.6302e+20, 6.1949e-04, 1.0256e-08, 6.5631e-07]]))
```  


```python
# (3, 2, 2)
x = torch.FloatTensor([[[1, 1],
                        [2, 2]],
                       [[3, 3],
                        [4, 4]],
                       [[5, 5],
                        [6, 6]]])
indice = torch.LongTensor([2, 1])

y = x.index_select(dim=0, index=indice)

# (2, 2, 2)
y
tensor([[[5., 5.],
         [6., 6.]],
        [[3., 3.],
         [4., 4.]]])
```

```python
x = torch.FloatTensor([[1, 2, 3],
                       [4, 5, 6],
                       [7, 8, 9]])
y = torch.FloatTensor([[10, 11, 12],
                       [13, 14, 15],
                       [16, 17, 18]])


z = torch.cat([x, y], dim=0)

z
z.size()
-------------------------------------
tensor([[ 1.,  2.,  3.],
        [ 4.,  5.,  6.],
        [ 7.,  8.,  9.],
        [10., 11., 12.],
        [13., 14., 15.],
        [16., 17., 18.]])
torch.Size([6, 3])

z = torch.cat([x, y], dim=-1)

z
z.size()
------------------------------------
tensor([[ 1.,  2.,  3., 10., 11., 12.],
        [ 4.,  5.,  6., 13., 14., 15.],
        [ 7.,  8.,  9., 16., 17., 18.]])
torch.Size([3, 6])
```

```python
z = torch.stack([x, y])

z
z.size()
-----------------------------------
tensor([[[ 1.,  2.,  3.],
         [ 4.,  5.,  6.],
         [ 7.,  8.,  9.]],

        [[10., 11., 12.],
         [13., 14., 15.],
         [16., 17., 18.]]])
torch.Size([2, 3, 3])


z = torch.stack([x, y], dim=1)

z
z.size()
------------------------------------
tensor([[[ 1.,  2.,  3.],
         [10., 11., 12.]],

        [[ 4.,  5.,  6.],
         [13., 14., 15.]],

        [[ 7.,  8.,  9.],
         [16., 17., 18.]]])
torch.Size([3, 2, 3])
```

```python
# (2, 1, 2)
x = torch.FloatTensor([[[1, 2]],
                       [[3, 4]]])

y = x.expand([2, 3, 2])

y
y.size()
-----------------------------------
tensor([[[1., 2.],
         [1., 2.],
         [1., 2.]],

        [[3., 4.],
         [3., 4.],
         [3., 4.]]])
torch.Size([2, 3, 2])
```

```python
x = torch.randperm(10)
x
------------------------
tensor([9, 0, 8, 4, 3, 6, 5, 2, 7, 1])
```

```python
x = torch.randperm(3**3).reshape(3, 3, -1)
x
------------------------------------------
tensor([[[18,  9, 25],
         [ 0, 16,  8],
         [24, 20, 14]],

        [[ 1,  4, 17],
         [ 2, 22,  7],
         [ 5, 10, 12]],

        [[15, 13, 23],
         [ 3, 21, 19],
         [26,  6, 11]]])

y = x.argmax(dim=-1)
y
-----------------------------------------
tensor([[2, 1, 0],
        [2, 1, 2],
        [2, 1, 0]])
```

```python
torch.ones(2, 3)
torch.zeros(2, 3)
---------------------------------------
tensor([[1., 1., 1.],
        [1., 1., 1.]])
tensor([[0., 0., 0.],
        [0., 0., 0.]])


x = torch.FloatTensor([[1, 2, 3],
                       [4, 5, 6]])

torch.ones_like(x)
torch.zeros_like(x)
-----------------------------------------
tensor([[1., 1., 1.],
        [1., 1., 1.]])
tensor([[0., 0., 0.],
        [0., 0., 0.]])
```  

## 5. GPUë¥¼ ì´ìš©í•œ í…ì„œ ê³„ì‚°  

ğŸ”” ê°™ì€ ë””ë°”ì´ìŠ¤ì— ìˆëŠ” í…ì„œë¼ë¦¬ë§Œ ì—°ì‚°ì´ ê°€ëŠ¥í•˜ë‹¤ (RAMì— ìˆëŠ” í…ì„œë¼ë¦¬ ë˜ëŠ” GPU RAMì— ìˆëŠ” í…ì„œë¼ë¦¬)  

### 1) Convert to CUDA tensor  

```python

import torch
import torch.nn as nn
```   

```python
x = torch.cuda.FloatTensor(2, 2)

x
--------------------------------
tensor([[0., 0.],
        [0., 0.]], device='cuda:0')
```

```python
x = torch.FloatTensor(2, 2)

x
--------------------------------
tensor([[-4.4256e-10,  4.5685e-41],
        [-4.4256e-10,  4.5685e-41]])

# moveì•„ë‹ˆê³  copy -> xëŠ” ì—¬ì „íˆ CPUì— ìˆë‹¤
x.cuda()
--------------------------------
tensor([[-4.4256e-10,  4.5685e-41],
        [-4.4256e-10,  4.5685e-41]], device='cuda:0')
```  

```python
d = torch.device('cuda:0')

x.cuda(device=d)
--------------------------------
tensor([[-4.4256e-10,  4.5685e-41],
        [-4.4256e-10,  4.5685e-41]], device='cuda:0')

x.device
----------------------------------
device(type='cpu')
```

```python
# ì¡°ê¸ˆ ë” ìµœê·¼ì— ë‚˜ì˜¨ ë°©ë²•
x.to(device=d)
----------------------------------
tensor([[0.0000e+00, 0.0000e+00],
        [7.0065e-45, 0.0000e+00]], device='cuda:0')
```

### 2) Convert to CPU tensor from CUDA tensor  

```python
x = torch.cuda.FloatTensor(2, 2)

x = x.cpu()

d = torch.device('cpu')
x = x.to(d)
```

### 3) Move model from CPU to GPU

```python
linear = nn.Linear(2, 2)
```   

```python
def print_params(model):
    for p in model.parameters():
        print(p)
```  

```python
print_params(linear)
-------------------------------------------
Parameter containing:
tensor([[-0.6343,  0.0866],
        [-0.2044, -0.0207]], requires_grad=True)
Parameter containing:
tensor([0.1993, 0.5434], requires_grad=True)
```  

```python
linear = linear.cuda()

print_params(linear)
-----------------------------------------------
Parameter containing:
tensor([[ 0.5782,  0.4288],
        [-0.0220, -0.1614]], device='cuda:0', requires_grad=True)
Parameter containing:
tensor([0.6881, 0.0907], device='cuda:0', requires_grad=True)
```

```python
linear = linear.cpu()

print_params(linear)
----------------------------------------------
Parameter containing:
tensor([[ 0.5782,  0.4288],
        [-0.0220, -0.1614]], requires_grad=True)
Parameter containing:
tensor([0.6881, 0.0907], requires_grad=True)
```  

```python
d = torch.device('cuda:0')
linear = linear.to(d)

print_params(linear)
--------------------------------------------------
Parameter containing:
tensor([[-0.6343,  0.0866],
        [-0.2044, -0.0207]], device='cuda:0', requires_grad=True)
Parameter containing:
tensor([0.1993, 0.5434], device='cuda:0', requires_grad=True)
```

ğŸ”” ì•ì—ì„œ ì •ì˜í•œ í…ì„œë‚˜ ëª¨ë¸ê³¼ ê°™ì€ ì¥ì¹˜ì— ìˆëŠ” ìƒˆë¡œìš´ í…ì„œ ë˜ëŠ” ëª¨ë¸ ë§Œë“¤ê¸°  

```python
x = torch.cuda.FloatTensor(2, 2)

x.new(2, 2)
----------------------------------
tensor([[2.3694e-38, 1.2422e-01],
        [1.4013e-45, 0.0000e+00]], device='cuda:0')


torch.zeros_like(x)
-----------------------------------
tensor([[0., 0.],
        [0., 0.]], device='cuda:0')


torch.ones_like(x)
-----------------------------------
tensor([[1., 1.],
        [1., 1.]], device='cuda:0')


list(linear.parameters())[0].new(2, 2)
-------------------------------------
tensor([[1., 1.],
        [1., 1.]], device='cuda:0')
```