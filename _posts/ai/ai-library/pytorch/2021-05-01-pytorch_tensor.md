---
title:  "[Pytorch] 텐서 다루기"
toc: true
toc_sticky: true
header:
  teaser: /assets/images/deep_learning.jpg

categories:
  - Pytorch
tags:
  - AI
last_modified_at: 2021-05-01
---  

```python
import torch

torch.__version__
--------------------
'1.7.1'
```  

```python
a = torch.FloatTensor([[1, 2], [3, 4]])
b = torch.LongTensor([[1, 2], [3, 4]])
c = torch.ByteTensor([[1, 2], [3, 4]])
```  

```python
a.shape
a.size()
a.size(-1)
a.dim()
-----------
torch.Size([2, 2])
torch.Size([2, 2])
2
2
```  

```python
# 텐서를 넘파이 배열로
a = a.numpy()

# 넘파이 배열을 텐서로
a = torch.from_numpy(a)
```  

```python
a = torch.FloatTensor([[1, 2],
                       [3, 4]])
b = torch.FloatTensor([[2, 2],
                       [3, 3]])

a+b
-------------------------
tensor([[3., 4.],
        [6., 7.]])

a-b
-------------------------
tensor([[-1.,  0.],
        [ 0.,  1.]])

a*b
-------------------------
tensor([[ 2.,  4.],
        [ 9., 12.]])

a/b
-------------------------
tensor([[0.5000, 1.0000],
        [1.0000, 1.3333]])

a==b
-------------------------
tensor([[False,  True],
        [ True, False]])

a**b
-------------------------
tensor([[ 1.,  4.],
        [27., 64.]])
```  

```python
a = torch.FloatTensor([[1, 2],
                       [3, 4]])
b = torch.FloatTensor([[2, 2],
                       [3, 3]])

# a*b의 결과를 리턴
a.mul(b)

# a*b의 결과를 a에 리턴
a.mul_(b)

# a+b의 결과를 a에 리턴
a.add_(b)
```  

```python
a = torch.FloatTensor([[1, 2],
                       [3, 4]])

a.sum()
a.mean()
----------
10
2.5

a.sum(dim=0)
a.sum(dim=-1)
--------------
tensor([4., 6.])
tensor([3., 7.])
```

```python
x = torch.FloatTensor([[[1, 2],
                        [3, 4]],
                       [[5, 6],
                        [7, 8]],
                       [[9, 10],
                        [11, 12]]])

x.reshape(12)
x.reshape(-1)
------------------------------------
tensor([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.])
tensor([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.])


x.reshape(3, 1, 4)
x.reshape(-1, 1, 4)
------------------------------------
tensor([[[ 1.,  2.,  3.,  4.]],

        [[ 5.,  6.,  7.,  8.]],

        [[ 9., 10., 11., 12.]]])
tensor([[[ 1.,  2.,  3.,  4.]],

        [[ 5.,  6.,  7.,  8.]],

        [[ 9., 10., 11., 12.]]])
```

```python
# size: (1, 2, 2)
x = torch.FloatTensor([[[1, 2],
                        [3, 4]]])

# size: (2, 2)
x = x.squeeze()

# size: (1, 2, 2)
x = x.unsqueeze(0)

# size: (2, 1, 2)
x = x.unsqueeze(1)

# size: (2, 2, 1)
x = x.unsqueeze(-1)
```

```python
x = torch.FloatTensor([[[1, 2],
                        [3, 4]],
                       [[5, 6],
                        [7, 8]],
                       [[9, 10],
                        [11, 12]]])

x[0]
x[0, :]
x[0, :, :]
-------------------------------------
tensor([[1., 2.],
        [3., 4.]])
tensor([[1., 2.],
        [3., 4.]])
tensor([[1., 2.],
        [3., 4.]])

x[1:3, :, :]
----------------------------------------
tensor([[[ 5.,  6.],
         [ 7.,  8.]],

        [[ 9., 10.],
         [11., 12.]]])
```

```python
x = torch.FloatTensor(10, 4)

# 4개씩 자른다
splits = x.split(4, dim=0)

splits
----------------------------------------------------------
(tensor([[0.0000e+00, 1.0102e-38, 1.8788e+31, 1.7220e+22],
         [1.8704e+20, 6.5986e-10, 1.3029e-11, 1.0524e+21],
         [2.0314e+20, 6.6766e-07, 1.7000e+22, 1.7567e-04],
         [4.1765e-08, 2.4693e-18, 1.8788e+31, 7.9303e+34]]),
 tensor([[6.1949e-04, 2.8183e+20, 3.2995e-18, 1.9421e+31],
         [2.7491e+20, 6.1949e-04, 7.1856e+22, 4.3605e+27],
         [2.3329e-18, 1.9284e+31, 3.2314e-18, 6.6448e+22],
         [1.6805e-04, 1.6149e-07, 5.2711e-08, 2.6586e+23]]),
 tensor([[2.0891e+20, 2.6965e+23, 4.3125e-08, 2.4286e-18],
         [2.6302e+20, 6.1949e-04, 1.0256e-08, 6.5631e-07]]))

# 3개의 덩어리로 나눈다
chunks = x.chunk(3, dim=0)

chunks
---------------------------------------------------------
(tensor([[0.0000e+00, 1.0102e-38, 1.8788e+31, 1.7220e+22],
         [1.8704e+20, 6.5986e-10, 1.3029e-11, 1.0524e+21],
         [2.0314e+20, 6.6766e-07, 1.7000e+22, 1.7567e-04],
         [4.1765e-08, 2.4693e-18, 1.8788e+31, 7.9303e+34]]),
 tensor([[6.1949e-04, 2.8183e+20, 3.2995e-18, 1.9421e+31],
         [2.7491e+20, 6.1949e-04, 7.1856e+22, 4.3605e+27],
         [2.3329e-18, 1.9284e+31, 3.2314e-18, 6.6448e+22],
         [1.6805e-04, 1.6149e-07, 5.2711e-08, 2.6586e+23]]),
 tensor([[2.0891e+20, 2.6965e+23, 4.3125e-08, 2.4286e-18],
         [2.6302e+20, 6.1949e-04, 1.0256e-08, 6.5631e-07]]))
```  


```python
# (3, 2, 2)
x = torch.FloatTensor([[[1, 1],
                        [2, 2]],
                       [[3, 3],
                        [4, 4]],
                       [[5, 5],
                        [6, 6]]])
indice = torch.LongTensor([2, 1])

y = x.index_select(dim=0, index=indice)

# (2, 2, 2)
y
tensor([[[5., 5.],
         [6., 6.]],
        [[3., 3.],
         [4., 4.]]])
```

```python
x = torch.FloatTensor([[1, 2, 3],
                       [4, 5, 6],
                       [7, 8, 9]])
y = torch.FloatTensor([[10, 11, 12],
                       [13, 14, 15],
                       [16, 17, 18]])


z = torch.cat([x, y], dim=0)

z
z.size()
-------------------------------------
tensor([[ 1.,  2.,  3.],
        [ 4.,  5.,  6.],
        [ 7.,  8.,  9.],
        [10., 11., 12.],
        [13., 14., 15.],
        [16., 17., 18.]])
torch.Size([6, 3])

z = torch.cat([x, y], dim=-1)

z
z.size()
------------------------------------
tensor([[ 1.,  2.,  3., 10., 11., 12.],
        [ 4.,  5.,  6., 13., 14., 15.],
        [ 7.,  8.,  9., 16., 17., 18.]])
torch.Size([3, 6])
```

```python
z = torch.stack([x, y])

z
z.size()
-----------------------------------
tensor([[[ 1.,  2.,  3.],
         [ 4.,  5.,  6.],
         [ 7.,  8.,  9.]],

        [[10., 11., 12.],
         [13., 14., 15.],
         [16., 17., 18.]]])
torch.Size([2, 3, 3])


z = torch.stack([x, y], dim=1)

z
z.size()
------------------------------------
tensor([[[ 1.,  2.,  3.],
         [10., 11., 12.]],

        [[ 4.,  5.,  6.],
         [13., 14., 15.]],

        [[ 7.,  8.,  9.],
         [16., 17., 18.]]])
torch.Size([3, 2, 3])
```

```python
# (2, 1, 2)
x = torch.FloatTensor([[[1, 2]],
                       [[3, 4]]])

y = x.expand([2, 3, 2])

y
y.size()
-----------------------------------
tensor([[[1., 2.],
         [1., 2.],
         [1., 2.]],

        [[3., 4.],
         [3., 4.],
         [3., 4.]]])
torch.Size([2, 3, 2])
```

```python
x = torch.randperm(10)
x
------------------------
tensor([9, 0, 8, 4, 3, 6, 5, 2, 7, 1])
```

```python
x = torch.randperm(3**3).reshape(3, 3, -1)
x
------------------------------------------
tensor([[[18,  9, 25],
         [ 0, 16,  8],
         [24, 20, 14]],

        [[ 1,  4, 17],
         [ 2, 22,  7],
         [ 5, 10, 12]],

        [[15, 13, 23],
         [ 3, 21, 19],
         [26,  6, 11]]])

y = x.argmax(dim=-1)
y
-----------------------------------------
tensor([[2, 1, 0],
        [2, 1, 2],
        [2, 1, 0]])
```

```python
torch.ones(2, 3)
torch.zeros(2, 3)
---------------------------------------
tensor([[1., 1., 1.],
        [1., 1., 1.]])
tensor([[0., 0., 0.],
        [0., 0., 0.]])


x = torch.FloatTensor([[1, 2, 3],
                       [4, 5, 6]])

torch.ones_like(x)
torch.zeros_like(x)
-----------------------------------------
tensor([[1., 1., 1.],
        [1., 1., 1.]])
tensor([[0., 0., 0.],
        [0., 0., 0.]])
```